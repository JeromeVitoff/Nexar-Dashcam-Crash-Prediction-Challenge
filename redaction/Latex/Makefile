# Makefile pour compiler le m√©moire LaTeX
# Auteur: VITOFFODJI Adjimon
# Ann√©e: 2025-2026

# Variables
MAIN = manuscript
TEX = pdflatex
BIB = bibtex
VIEWER = open  # Sur macOS. Utiliser 'xdg-open' sur Linux, 'start' sur Windows

# Compiler le PDF complet
all: $(MAIN).pdf

# Compilation compl√®te avec bibliographie
$(MAIN).pdf: $(MAIN).tex chapters/*.tex references.bib
	@echo "üî® Compilation LaTeX (pass 1/4)..."
	$(TEX) -interaction=nonstopmode $(MAIN).tex
	@echo "üìö G√©n√©ration de la bibliographie..."
	$(BIB) $(MAIN)
	@echo "üî® Compilation LaTeX (pass 2/4)..."
	$(TEX) -interaction=nonstopmode $(MAIN).tex
	@echo "üî® Compilation LaTeX (pass 3/4)..."
	$(TEX) -interaction=nonstopmode $(MAIN).tex
	@echo "üî® Compilation LaTeX (pass 4/4)..."
	$(TEX) -interaction=nonstopmode $(MAIN).tex
	@echo "‚úÖ Compilation termin√©e: $(MAIN).pdf"

# Compilation rapide (sans bibliographie)
quick:
	@echo "‚ö° Compilation rapide..."
	$(TEX) -interaction=nonstopmode $(MAIN).tex
	@echo "‚úÖ Compilation rapide termin√©e"

# Voir le PDF
view: $(MAIN).pdf
	@echo "üëÄ Ouverture du PDF..."
	$(VIEWER) $(MAIN).pdf

# Nettoyer les fichiers auxiliaires
clean:
	@echo "üßπ Nettoyage des fichiers temporaires..."
	rm -f $(MAIN).aux
	rm -f $(MAIN).log
	rm -f $(MAIN).toc
	rm -f $(MAIN).lof
	rm -f $(MAIN).lot
	rm -f $(MAIN).out
	rm -f $(MAIN).bbl
	rm -f $(MAIN).blg
	rm -f $(MAIN).mtc*
	rm -f $(MAIN).maf
	rm -f chapters/*.aux
	@echo "‚úÖ Nettoyage termin√©"

# Nettoyer tout (y compris le PDF)
cleanall: clean
	@echo "üßπ Suppression du PDF..."
	rm -f $(MAIN).pdf
	@echo "‚úÖ Nettoyage complet termin√©"

# Compter les mots (approximatif)
wordcount:
	@echo "üìä Comptage des mots..."
	@texcount -inc -sum $(MAIN).tex

# V√©rifier les erreurs LaTeX
check:
	@echo "üîç V√©rification des erreurs..."
	$(TEX) -interaction=nonstopmode $(MAIN).tex | grep -i "error\|warning"

# Afficher l'aide
help:
	@echo "üìñ Commandes disponibles:"
	@echo "  make          - Compiler le PDF complet (avec bibliographie)"
	@echo "  make quick    - Compilation rapide (sans bibliographie)"
	@echo "  make view     - Ouvrir le PDF"
	@echo "  make clean    - Nettoyer les fichiers temporaires"
	@echo "  make cleanall - Nettoyer tout (y compris le PDF)"
	@echo "  make wordcount - Compter les mots"
	@echo "  make check    - V√©rifier les erreurs"
	@echo "  make help     - Afficher cette aide"

# D√©clarer les cibles qui ne sont pas des fichiers
.PHONY: all quick view clean cleanall wordcount check help
